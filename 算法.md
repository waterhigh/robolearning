### 参数定义

1. **$ A $**：目标基因。
2. **$ N $**：基因 \( A \) 的总变异数量（即表格中基因 \( A \) 对应的所有不同变异数量）。
3. **$ M $**：病人样本中检测到的基因 \( A \) 的变异数量。
4. **$ T $**：病人样本中所有基因的总变异数量（包括其他基因的变异）。
5. **$ X $**：所有病人样本的总数。
6. **$ Y_i $**：基因 \( A \) 的第 \( i \) 个变异在所有病人样本中出现的次数。
7. **$ K $**：基因 \( A \) 的特征得分（已知，可能基于生物学意义或其他特征得出）。

### 目标

计算基因 \( A \) 在病人样本中的总分数 \( W \)，该分数反映基因 \( A \) 在该病人样本中的相对重要性。

### 公式

基因 \( A \) 在病人样本中的总分数 \( W \) 计算公式如下：

$$
W = K \times \frac{M}{N} \times \frac{M}{T} \times \left( \frac{1}{X} \sum_{i=1}^{M} Y_i \right)
$$

#### 公式解释
- **$\frac{M}{N} $**：病人样本中基因 \( A \) 的变异数量占基因 \( A \) 总变异数量的比例，反映了基因 \( A \) 在该病人样本中的覆盖度。
- **$ \frac{M}{T} $**：基因 \( A \) 的变异在病人样本所有变异中的比例，表示基因 \( A \) 在该病人样本中的相对频率。
- **$\frac{1}{X} \sum_{i=1}^{M} Y_i $**：基因 \( A \) 的 \( M \) 个变异在所有样本中的平均出现频率，用于加权调整稀有或常见变异对权重的影响。
- **$ K $**：基因 \( A \) 的特征得分，是基因在所有样本中的总体重要性。

### 例子

假设：
- 基因 \( A \) 总共有 \( N = 10 \) 个变异。
- 病人样本总共有 \( T = 50 \) 个变异（包括其他基因的变异）。
- 病人样本中检测到 \( M = 4 \) 个基因 \( A \) 的变异。
- 基因 \( A \) 的特征得分为 \( K = 100 \)。
- 总共有 \( X = 100 \) 个病人样本。
- 这 \( M = 4 \) 个变异在所有病人样本中分别出现了 \( Y_1 = 20 \), \( Y_2 = 30 \), \( Y_3 = 15 \), \( Y_4 = 25 \) 次。

#### 计算步骤

1. **计算平均出现频率**：

   $$
   \frac{1}{X} \sum_{i=1}^{M} Y_i = \frac{1}{100} \times (20 + 30 + 15 + 25) = \frac{1}{100} \times 90 = 0.9
   $$

2. **代入公式计算 \( W \)**：

   $$
   W = 100 \times \frac{4}{10} \times \frac{4}{50} \times 0.9
   $$

3. **逐步计算**：

   - 计算 $\frac{4}{10} = 0.4 $
   - 计算 $ \frac{4}{50} = 0.08 $
   - 计算最终得分：

     $$
     W = 100 \times 0.4 \times 0.08 \times 0.9 = 2.88
     $$

### 最终结果

基因 \( A \) 在该病人样本中的加权总分数 \( W \) 为 **2.88**。这个分数反映了基因 \( A \) 在该病人样本中的相对重要性，考虑了基因的特征得分、变异比例和稀有度。

--- 

通过这种方法，稀有变异的权重被放大，而常见变异的权重则被削弱，使得该算法能够有效地识别与疾病相关的驱动基因。